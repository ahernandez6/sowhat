# The following are a set of tests that can be used to make sure
# sowh.pl is running correctly and provide examples 
# 
# To make tests go faster add --reps=10
# this is especially relevant to amino acid tests which take a while
# 

# TEST1: Nucleotide data under GTRGAMMA without partitions
# constraint tree is much less likely than tree w/highest likelihood
# p-value should be close to 0
perl sowh.pl --constraint=examples/H1.tre --aln=examples/nt.phy --model=GTRGAMMA --dir=OUT_DIR.nt.H1 --name=nt.H1

# TEST2:
# constraint tree is the tree w/highest likelihood
# p-value should be close to 0
perl sowh.pl --constraint=examples/H0.tre --aln=examples/nt.phy --model=GTRGAMMA --dir=OUT_DIR.nt.H0 --name=nt.H0

# TEST3:
# constraint tree is not significantly worse than the tree w/highest likelihood
# p-value may vary but should be > 0.05
perl sowh.pl --constraint=examples/H2.tre --aln=examples/nt.phy --model=GTRGAMMA --dir=OUT_DIR.nt.H2 --name=nt.H2

# TEST4: Amino acid data under PROTGAMMAWAG with partitions
# constraint tree is much less likely than tree w/highest likelihood
# p-value should be close to 1
perl sowh.pl --constraint=examples/H0.tre --aln=examples/aa.phy --partition=examples/aa.partitions --model=PROTGAMMAWAG --dir=OUT_DIR.aa.H0.parts --name=aa.H0.parts

# TEST5: Nucleotide data under GTRCAT with partitions
# constraint tree is much less likely than tree w/highest likelihood
# p-value should be close to 1
perl sowh.pl --constraint=examples/H1.tre --aln=examples/nt.phy --partition=examples/nt.partitions --model=GTRCAT --dir=OUT_DIR.nt.H0.parts --name=nt.H0.parts

